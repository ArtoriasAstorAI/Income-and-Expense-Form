<script>
    const formContainer = document.getElementById('formContainer');
    const entries = [];
  
    function formatTodayDate() {
      const today = new Date();
      return today.toISOString().split("T")[0];
    }
  
    function addIncome() {
      const div = document.createElement('div');
      div.innerHTML = `
        <h3>Income Entry</h3>
        <label>Date: <input type="date" class="entryDate" value="${formatTodayDate()}" required></label><br>
        <label>Client Name: <input type="text" class="clientName" required></label><br>
        <label>Number of Cars: <input type="number" class="cars" required></label><br>
        <label>Income Amount: <input type="number" class="amount" required></label><br>
        <label>Job Description:<br><textarea class="description" rows="3" cols="40"></textarea></label><br><hr>
      `;
      formContainer.insertBefore(div, formContainer.lastElementChild);
      div.classList.add('incomeEntry');
    }
  
    function addExpense() {
      const div = document.createElement('div');
      div.innerHTML = `
        <h3>Expense Entry</h3>
        <label>Date: <input type="date" class="entryDate" value="${formatTodayDate()}" required></label><br>
        <label>Expense Title: <input type="text" class="title" required></label><br>
        <label>Cost: <input type="number" class="cost" required></label><br><hr>
      `;
      formContainer.insertBefore(div, formContainer.lastElementChild);
      div.classList.add('expenseEntry');
    }
  
    async function submitData() {
      entries.length = 0;
  
      document.querySelectorAll('.incomeEntry').forEach(entry => {
        entries.push({
          type: "Income",
          date: entry.querySelector('.entryDate').value,
          clientName: entry.querySelector('.clientName').value,
          cars: entry.querySelector('.cars').value,
          amount: entry.querySelector('.amount').value,
          description: entry.querySelector('.description').value
        });
      });
  
      document.querySelectorAll('.expenseEntry').forEach(entry => {
        entries.push({
          type: "Expense",
          date: entry.querySelector('.entryDate').value,
          title: entry.querySelector('.title').value,
          cost: entry.querySelector('.cost').value
        });
      });
  
      const url = "https://script.google.com/macros/s/AKfycbzfMl-L2fIseWj6YdUoBfBJsUJ7Tud1UhsWsx9YECT2tlus_nsIjk-JtOx6yqFWqCre/exec"; // replace with your URL
  
      try {
        const res = await fetch(url, {
          method: "POST",
          body: JSON.stringify({ entries }),
          headers: { "Content-Type": "application/json" }
        });
  
        if (res.ok) {
          alert("Data submitted successfully!");
          location.reload();
        } else {
          alert("Failed to submit. Please try again.");
        }
      } catch (err) {
        alert("Error submitting: " + err.message);
      }
    }
  </script>